## 🧭 PHASE 1 — Post-Installation Hardening & Verification

These are your “Day-2 operations” tasks — ensuring your cluster is **secure**, **consistent**, and **monitorable**.

### 1. Verify Cluster Health

```bash
kubectl get nodes -o wide
kubectl get pods -A
kubectl get componentstatuses  # Deprecated, use metrics-server / kubelet health checks instead
```

✅ **Goal:** All system pods (CoreDNS, kube-proxy, flannel, etc.) should be Running.

---

### 2. Label & Taint Nodes Properly

Give your nodes roles and zones for better scheduling:

```bash
kubectl label node pc2 node-role.kubernetes.io/worker=worker
kubectl label node pc4 node-role.kubernetes.io/worker=worker
```

(Then check)

```bash
kubectl get nodes --show-labels
```

🧠 **Trick:** *“Labels lead, taints teach”* —
Labels help the scheduler decide **where** to run pods.
Taints restrict **what** runs on a node.

---

### 3. Install Metrics Server (for `kubectl top`)

```bash
kubectl apply -f https://github.com/kubernetes-sigs/metrics-server/releases/latest/download/components.yaml
```

Then:

```bash
kubectl top nodes
kubectl top pods -A
```

---

### 4. Enable Cluster Auto-Completion & Alias

```bash
echo 'source <(kubectl completion bash)' >> ~/.bashrc
echo 'alias k=kubectl' >> ~/.bashrc
echo 'complete -F __start_kubectl k' >> ~/.bashrc
source ~/.bashrc
```

---

## 🛡️ PHASE 2 — Security & Access Control

### 1. Create User Access with RBAC

Create a service account for an admin:

```bash
kubectl create serviceaccount cluster-admin -n kube-system
kubectl create clusterrolebinding cluster-admin-binding \
  --clusterrole=cluster-admin --serviceaccount=kube-system:cluster-admin
```

### 2. Restrict API Server Access

Limit API server to internal subnets in your HAProxy or firewall.

### 3. Enable Audit Logging

Add to `/etc/kubernetes/manifests/kube-apiserver.yaml`:

```yaml
--audit-log-path=/var/log/kubernetes/audit.log
--audit-log-maxage=30
```

---

## 📦 PHASE 3 — Deploy Core Add-Ons

| Function                   | Recommended Add-on       | Equivalent         |
| -------------------------- | ------------------------ | ------------------ |
| Ingress Controller         | NGINX Ingress Controller | Open source        |
| Certificate Management     | cert-manager             | ACME/Let's Encrypt |
| Monitoring                 | Prometheus + Grafana     | Open source        |
| Logging                    | Loki + Promtail          | Open source        |
| Dashboard                  | Kubernetes Dashboard     | Open source        |
| Load Balancer (Bare Metal) | MetalLB                  | Open source        |

Example (MetalLB install):

```bash
kubectl apply -f https://raw.githubusercontent.com/metallb/metallb/v0.14.4/config/manifests/metallb-native.yaml
```

---

## ⚙️ PHASE 4 — Cluster Operations & Maintenance

### 1. Backup & Restore

* **etcd snapshot:**

  ```bash
  ETCDCTL_API=3 etcdctl snapshot save /tmp/etcd-backup.db
  ```
* **Restore when needed:**

  ```bash
  ETCDCTL_API=3 etcdctl snapshot restore /tmp/etcd-backup.db
  ```

### 2. Upgrades

Follow version skew rules (control plane first → workers):

```bash
sudo apt-mark unhold kubeadm kubelet kubectl
sudo apt-get install -y kubeadm=1.31.x-00
sudo kubeadm upgrade plan
sudo kubeadm upgrade apply v1.31.x
sudo apt-get install -y kubelet=1.31.x-00 kubectl=1.31.x-00
sudo systemctl restart kubelet
```

---

## ☁️ PHASE 5 — Cluster Expansion or Integration

| Goal                         | Next Step                                               |
| ---------------------------- | ------------------------------------------------------- |
| Manage cluster declaratively | Use **Cluster API** or **Ansible + kubeadm**            |
| Hybrid / multi-cloud         | Integrate with **KubeFed** or **Rancher**               |
| CI/CD automation             | Use **ArgoCD** or **FluxCD**                            |
| AI/ML workloads              | Deploy **Kubeflow** (you already mentioned interest 😉) |

---

## 🧠 Memorization Trick

> “**Build → Secure → Observe → Expand**”

That’s the Kubernetes admin lifecycle:

1. **Build** the cluster (✅ you’ve done this)
2. **Secure** it (RBAC, TLS, audit logs)
3. **Observe** it (metrics, logging, dashboards)
4. **Expand** it (apps, CI/CD, multi-cluster, Kubeflow)

---

